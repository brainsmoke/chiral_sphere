
r = 122.31591246532409;
w = 17.5;
h = 19.0;
subdivisions = 2;
thickness = 3.0;




module subdiv_arc(a, n)
{
    if (n > 0)
        rotate([0,0,a])
        {
            children();
            subdiv_arc(a,n-1)children();
        }
}

module joint()
{
    translate([r,0,0])
    rotate([0,-90,0])
    rotate([0,0,A+90])
    top_joint();

    translate([r-h,0,0])
    rotate([0,90,0])
    rotate([0,0,-A-90])
    bottom_joint();
}

module subdiv()
{
    translate([r,0,0])
    rotate([0,-90,0])
    rotate([0,0,90])
    top_div();

    translate([r-h,0,0])
    rotate([0,90,0])
    rotate([0,0,-90])
    bottom_div();
}

module big_side()
{
    translate([r-h,(w/2)*(cos_A+1)/sin(A),-w/2])
    rotate([180-A,0,0])
    rotate([0,0,-90])
    big_arc();
}

module small_side()
{
    translate([r-h,-(w/2)*(cos_A-1)/sin(A),w/2])
    rotate([180,0,0])
    rotate([0,0,-90])
    small_arc();
}

module arc()
{
    joint();

    subdiv_arc(alpha/2/subdivisions, subdivisions-1)subdiv();

    rotate([-A,0,0])
    subdiv_arc(alpha/2/subdivisions, subdivisions-1)subdiv();

    big_side();
    small_side();
}




/*
 * alpha = 2*beta
 * cos (alpha) = 1 / (1-cos(A)) - 1
 * cos (beta)  = 1 / (1+cos(A)) - 1
 *
 * let x = cos(A)
 *
 * 1 / (1-x) -1 = 2 * ( 1/(1+x) - 1 )^2 - 1
 *
 * 2x^3 - x^2 + 2x + 1 = 0
 */

cuberoot=pow(6*sqrt(177)-71,1/3);
cos_A=(1/6)*(1) -
      (1/6)*(11)/cuberoot +
      (1/6)*cuberoot;
A=acos(cos_A);

cos_alpha=1/(1-cos_A)-1;
alpha=acos(cos_alpha);

module step_x()
{
    rotate([0,0,alpha/2])rotate([A,0,0])
    children();
}

module step_y()
{
    rotate([0,0,3*alpha/2])rotate([180,0,0])
    children();
}

module tri()
{
    children();
    step_x(){
        children();
        step_x(){
            children();
        }
    }
}

module extend()
{
    children();
    step_y()tri()children();
}

module top_joint ()
{
	linear_extrude(thickness) polygon([[-28.056927156656833, 5.749999999999999],[-28.056927156656833, -5.75],[-25.056927156656833, -5.75],[-25.056927156656833, -8.75],[-15.99476469640929, -8.75],[-15.99476469640929, -5.75],[-12.99476469640929, -5.75],[-12.99476469640929, -8.75],[-10.215010276705465, -9.87825766832628],[-11.343267945031744, -12.658012088030103],[-14.123022364735569, -11.529754419703824],[-17.531173793866515, -19.926616470019557],[-14.75141937416269, -21.054874138345838],[-15.879677042488971, -23.83462855804966],[-5.223951766957644, -28.15961628663373],[-4.095694098631364, -25.379861866929907],[-1.3159396789275393, -26.50811953525619],[4.763538127033965, -11.529754419703824],[1.9837837073301405, -10.401496751377543],[3.1120413756564207, -7.62174233167372],[5.8917957953602444, -8.75],[5.8917957953602444, -5.75],[8.891795795360245, -5.75],[8.891795795360245, -8.75],[25.056927156656833, -8.75],[25.056927156656833, -5.75],[28.056927156656833, -5.749999999999999],[28.056927156656833, 5.75],[25.056927156656833, 5.75],[25.056927156656833, 8.75],[-25.056927156656833, 8.75],[-25.056927156656833, 5.75]],[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]]);
}
module bottom_joint ()
{
	linear_extrude(thickness) polygon([[21.29455527154073, 5.75],[21.29455527154073, 8.75],[-21.29455527154073, 8.75],[-21.29455527154073, 5.75],[-24.29455527154073, 5.75],[-24.29455527154073, -5.749999999999999],[-21.29455527154073, -5.75],[-21.29455527154073, -8.75],[-8.891795795360245, -8.75],[-8.891795795360245, -5.75],[-5.8917957953602444, -5.75],[-5.8917957953602444, -8.75],[-3.1120413756564203, -7.621742331673721],[-1.98378370733014, -10.401496751377547],[-4.763538127033964, -11.529754419703826],[-0.09903529789827603, -23.021962909849222],[2.680719121805548, -21.89370524152294],[3.808976790131828, -24.673459661226765],[14.464702065663156, -20.348471932642692],[13.336444397336876, -17.56871751293887],[16.1161988170407, -16.44045984461259],[14.123022364735569, -11.529754419703824],[11.343267945031744, -12.658012088030105],[10.215010276705465, -9.878257668326281],[12.99476469640929, -8.75],[12.99476469640929, -5.75],[15.99476469640929, -5.75],[15.99476469640929, -8.75],[21.29455527154073, -8.75],[21.29455527154073, -5.75],[24.29455527154073, -5.75],[24.29455527154073, 5.749999999999999]],[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]]);
}
module top_div ()
{
	linear_extrude(thickness) polygon([[-28.056927156656833, 5.749999999999999],[-28.056927156656833, -5.75],[-25.056927156656833, -5.75],[-25.056927156656833, -8.75],[25.056927156656833, -8.75],[25.056927156656833, -5.75],[28.056927156656833, -5.749999999999999],[28.056927156656833, 5.75],[25.056927156656833, 5.75],[25.056927156656833, 8.75],[-25.056927156656833, 8.75],[-25.056927156656833, 5.75]],[[0,1,2,3,4,5,6,7,8,9,10,11]]);
}
module bottom_div ()
{
	linear_extrude(thickness) polygon([[21.29455527154073, 5.75],[21.29455527154073, 8.75],[-21.29455527154073, 8.75],[-21.29455527154073, 5.75],[-24.29455527154073, 5.75],[-24.29455527154073, -5.749999999999999],[-21.29455527154073, -5.75],[-21.29455527154073, -8.75],[21.29455527154073, -8.75],[21.29455527154073, -5.75],[24.29455527154073, -5.75],[24.29455527154073, 5.749999999999999]],[[0,1,2,3,4,5,6,7,8,9,10,11]]);
}
module big_arc ()
{
	linear_extrude(thickness) polygon([[0, 0],[3.0, 0.0],[3.0, 3.0],[15.402759476180485, 3.0],[15.402759476180485, 0.0],[18.402759476180485, 0.0],[21.088375088735887, -1.3369625206409759],[22.425337609376864, 1.3486530919144264],[60.55133100915935, -17.63136176926402],[59.214368488518375, -20.316977381819424],[61.89998410107378, -21.6539399024604],[63.708338246674664, -24.047651515016952],[66.10204985923122, -22.239297369416064],[91.77411472857646, -56.22131352789233],[89.3804031160199, -58.029667673493215],[91.1887572616208, -60.42337928604977],[91.74083773336874, -63.37214295116683],[94.68960139848579, -62.82006247941888],[102.52714014513576, -104.68180304578297],[99.5783764800187, -105.23388351753091],[100.13045695176665, -108.18264718264797],[99.31055342904125, -111.06843272794106],[102.19633897433434, -111.88833625066646],[98.80665024565562, -123.8189042567026],[95.92086470036254, -122.9990007339772],[95.10096117763715, -125.88478627927029],[113.37760296449333, -131.07750858986446],[114.19750648721873, -128.19172304457138],[111.31172094192566, -127.37181952184598],[115.72967032474094, -111.8221187151148],[118.61545587003401, -112.6420222378402],[119.62815826541001, -109.0776492924168],[118.94625704083543, -105.43548903295672],[115.99749337571838, -105.98756950470467],[106.77519993225101, -56.7295985986817],[109.72396359736807, -56.17751812693375],[109.0420623727935, -52.53535786747367],[106.80847692745874, -49.5787691754072],[104.41476531490218, -51.38712332100809],[74.20689991506232, -11.401084981092678],[76.60061152761888, -9.592730835491793],[74.36702608228413, -6.636142143425317],[71.04989267754702, -4.984795235339744],[69.71293015690604, -7.6704108478951465],[24.850746973852022, 14.66303747935902],[26.187709494493, 17.34865309191442],[22.870576089755886, 18.999999999999996],[19.165131361296616, 18.999999999999996],[19.165131361296616, 15.999999999999996],[3.000000000000021, 16.0],[3.0000000000000213, 19.0],[2.4868995751603507e-14, 19.0]],[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]]);
}
module small_arc ()
{
	linear_extrude(thickness) polygon([[0, 0],[3.0, 0.0],[3.0, 3.0],[8.299790575131441, 3.0],[8.299790575131441, 0.0],[11.299790575131441, 0.0],[13.985406187686843, -1.3369625206409759],[15.322368708327819, 1.3486530919144264],[53.4483621081103, -17.63136176926402],[52.11139958746933, -20.316977381819424],[54.79701520002473, -21.6539399024604],[56.60536934562562, -24.047651515016952],[58.99908095818217, -22.239297369416064],[62.19371371063398, -26.468020784019366],[59.80000209807743, -28.276374929620253],[61.608356243678315, -30.670086542176804],[76.76852978986982, -19.217176953371194],[74.96017564426893, -16.82346534081464],[72.56646403171237, -18.631819486415523],[67.10393101401326, -11.401084981092655],[69.49764262656981, -9.592730835491771],[67.26405718123506, -6.6361421434253],[63.946923776497954, -4.9847952353397265],[62.60996125585698, -7.670410847895129],[17.747778072802955, 14.663037479359037],[19.084740593443932, 17.34865309191444],[15.767607188706819, 19.000000000000014],[12.062162460247551, 19.000000000000014],[12.062162460247551, 16.000000000000014],[3.0000000000000027, 16.000000000000018],[3.0000000000000036, 19.000000000000018],[3.552713678800501e-15, 19.000000000000018]],[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]]);
}
tri()extend()arc();
