
r = 234.2322087635666;
w = 17.5;
h = 19.0;
subdivisions = 2;
thickness = 3.0;




module subdiv_arc(a, n)
{
    if (n > 0)
        rotate([0,0,a])
        {
            children();
            subdiv_arc(a,n-1)children();
        }
}

module joint()
{
    translate([r-thickness,0,0])
    rotate([0,90,0])
    rotate([0,0,90-A])
    top_joint();
    
    translate([r-h+thickness,0,0])
    rotate([0,-90,0])
    rotate([0,0,A-90])
    bottom_joint();
}

module subdiv()
{
    translate([r-thickness,0,0])
    rotate([0,90,0])
    rotate([0,0,90])
    top_div();
    
    translate([r-h+thickness,0,0])
    rotate([0,-90,0])
    rotate([0,0,90])
    bottom_div();
}

module big_side()
{
    translate([r,(w/2)*(cos_A+1)/sin(A),-w/2])
    rotate([0,0,90])
    big_arc();
}

module small_side()
{
    translate([r,-(w/2)*(cos_A-1)/sin(A),w/2])
    rotate([180-A,0,0])
    rotate([0,0,90])
    small_arc();
}

module arc()
{
    joint();
    
    subdiv_arc(alpha/2/subdivisions, subdivisions-1)subdiv();

    rotate([-A,0,0])
    subdiv_arc(alpha/2/subdivisions, subdivisions-1)subdiv();
    
    big_side();
    small_side();
}




/*
* alpha = 2*beta
* cos (alpha) = 1 / (1-cos(A)) - 1
* cos (beta)  = (phi + 1) / (1+cos(A)) - 1
*
* let x = cos(A)
*
* 1 / (1-x) -1 = 2 * ( (phi + 1)/(1+x) - 1 )^2 - 1
*
* x^3+(-2*phi-1/2)x^2+(3*phi+2)x + (-phi-1/2) = 0
*/

phi=(1+sqrt(5))/2;
cuberoot=pow(118*phi+85+6*sqrt(1173*phi+729), 1/3);
cos_A=(1/6)*(4*phi+1) +
	 (1/6)*(12*phi+7)/cuberoot -
	 (1/6)*cuberoot;

A=acos(cos_A);

cos_alpha=1/(1-cos_A)-1;
alpha=acos(cos_alpha);

module step_x()
{
   rotate([0,0,alpha/2])rotate([A,0,0])
   children();
}

module step_y()
{
   rotate([0,0,3*alpha/2])rotate([180,0,0])
   children();
}

module penta()
{
   children();
   step_x(){
	   children();
	   step_x(){
		   children();
		   step_x(){
			   children();
			   step_x(){
				   children();
			   }
		   }
	   }
   }
}

module extend()
{
   children();
   step_y()step_x()step_x()step_x()
   {
	   penta()children();
	   step_y(){
		   penta()children();
		   step_x()step_x()step_y()children();
	   }
   }
}

module top_joint ()
{
	linear_extrude(thickness) polygon([[-26.48923938332176, -5.749999999999999],[-26.48923938332176, 5.75],[-23.48923938332176, 5.75],[-23.48923938332176, 8.75],[-8.867891302143057, 8.75],[-8.867891302143057, 5.75],[-5.867891302143057, 5.75],[-5.867891302143057, 8.75],[-3.092403492711501, 7.611286945847716],[-1.9536904385592173, 10.386774755279273],[-4.729178247990774, 11.525487809431556],[0.8206617284567681, 25.052612261687212],[3.5961495378883246, 23.91389920753493],[4.734862592040607, 26.689387016966485],[15.374232528194906, 22.324320309382728],[14.235519474042622, 19.54883249995117],[17.01100728347418, 18.410119445798887],[14.186415551987922, 11.525487809431556],[11.410927742556366, 12.66420086358384],[10.272214688404082, 9.888713054152284],[13.047702497835639, 8.75],[13.047702497835639, 5.75],[16.047702497835637, 5.75],[16.047702497835637, 8.75],[23.48923938332176, 8.75],[23.48923938332176, 5.75],[26.48923938332176, 5.749999999999999],[26.48923938332176, -5.75],[23.48923938332176, -5.75],[23.48923938332176, -8.75],[-23.48923938332176, -8.75],[-23.48923938332176, -5.75]]);
}
module bottom_joint ()
{
	linear_extrude(thickness) polygon([[21.65632937307959, -5.75],[21.65632937307959, -8.75],[-21.65632937307959, -8.75],[-21.65632937307959, -5.75],[-24.65632937307959, -5.75],[-24.656329373079586, 5.749999999999999],[-21.65632937307959, 5.75],[-21.65632937307959, 8.75],[-16.047702497835637, 8.75],[-16.047702497835637, 5.75],[-13.047702497835639, 5.75],[-13.047702497835639, 8.75],[-10.272214688404084, 9.888713054152284],[-11.410927742556368, 12.66420086358384],[-14.186415551987924, 11.525487809431556],[-16.31528776489113, 16.714379649394818],[-13.539799955459575, 17.8530927035471],[-14.678513009611859, 20.628580512978658],[-4.0391430734575575, 24.993647220562416],[-2.900430019305274, 22.21815941113086],[-0.1249422098737174, 23.356872465283143],[4.729178247990774, 11.525487809431556],[1.9536904385592173, 10.386774755279273],[3.092403492711501, 7.611286945847716],[5.867891302143057, 8.75],[5.867891302143057, 5.75],[8.867891302143057, 5.75],[8.867891302143057, 8.75],[21.65632937307959, 8.75],[21.65632937307959, 5.75],[24.656329373079586, 5.750000000000001],[24.656329373079586, -5.749999999999999]]);
}
module top_div ()
{
	linear_extrude(thickness) polygon([[-26.48923938332176, -5.749999999999999],[-26.48923938332176, 5.75],[-23.48923938332176, 5.75],[-23.48923938332176, 8.75],[23.48923938332176, 8.75],[23.48923938332176, 5.75],[26.48923938332176, 5.749999999999999],[26.48923938332176, -5.75],[23.48923938332176, -5.75],[23.48923938332176, -8.75],[-23.48923938332176, -8.75],[-23.48923938332176, -5.75]]);
}
module bottom_div ()
{
	linear_extrude(thickness) polygon([[21.65632937307959, -5.75],[21.65632937307959, -8.75],[-21.65632937307959, -8.75],[-21.65632937307959, -5.75],[-24.65632937307959, -5.75],[-24.656329373079586, 5.749999999999999],[-21.65632937307959, 5.75],[-21.65632937307959, 8.75],[21.65632937307959, 8.75],[21.65632937307959, 5.75],[24.656329373079586, 5.750000000000001],[24.656329373079586, -5.749999999999999]]);
}
module big_arc ()
{
	linear_extrude(thickness) polygon([[0, 0],[0.0, 19.0],[3.0, 19.0],[3.0, 16.0],[8.608626875243953, 16.0],[8.608626875243953, 19.0],[11.608626875243953, 19.0],[14.53090714629552, 19.67843792451688],[15.209345070812404, 16.756157653465312],[57.3999211177091, 26.551141088482723],[56.72148319319221, 29.473421359534292],[59.64376346424379, 30.151859284051177],[62.336911452628605, 31.473583125350416],[63.658635293927844, 28.7804351369656],[102.54110188520005, 47.86289303525113],[101.2193780439008, 50.55604102363595],[103.91252603228563, 51.87776486493519],[106.23700125022017, 53.77429194388981],[108.1335283291748, 51.449816725955266],[141.69326228860908, 78.83102678382582],[139.79673520965446, 81.15550200176037],[142.121210427589, 83.052029080715],[143.95657448581647, 85.42509435031187],[146.32963975541333, 83.58973029208441],[149.76093048302374, 88.02627617467408],[147.3878652134269, 89.86164023290154],[149.22322927165436, 92.2347055024984],[164.25264264576785, 80.61073313372451],[162.4172785875404, 78.23766786412764],[160.04421331794353, 80.0730319223551],[155.49157020541182, 74.18661434389806],[157.8646354750087, 72.3512502856706],[155.8190178446085, 69.7063340730986],[153.22825800820445, 67.59254677741202],[151.33173092924983, 69.91702199534657],[114.93162770614084, 40.21836962566848],[116.82815478509546, 37.89389440773394],[114.23739494869142, 35.780107112047354],[111.23572834112072, 34.30697071702979],[109.91400449982147, 37.00011870541461],[67.7406726372332, 16.302593567467],[69.06239647853245, 13.609445579082184],[66.06072987096175, 12.136309184064626],[62.80368230231371, 11.38015153059931],[62.125244377796825, 14.302431801650878],[16.36381715653771, 3.6784379245168477],[17.04225508105459, 0.7561576534652801],[13.78520751240655, -3.375077994860476e-14],[10.441536885486144, -2.556436045160127e-14],[10.441536885486151, 2.9999999999999742],[3.0000000000000075, 2.9999999999999925],[3.0, -7.344999322983579e-15]]);
}
module small_arc ()
{
	linear_extrude(thickness) polygon([[0, 0],[0.0, 19.0],[3.0, 19.0],[3.0, 16.0],[15.788438070936532, 16.0],[15.788438070936532, 19.0],[18.788438070936532, 19.0],[21.710718341988102, 19.67843792451688],[22.389156266504983, 16.756157653465312],[64.57973231340168, 26.551141088482723],[63.90129438888479, 29.473421359534292],[66.82357465993637, 30.151859284051177],[69.51672264832119, 31.473583125350416],[70.83844648962044, 28.7804351369656],[82.31883191139593, 34.414696300744154],[80.99710807009669, 37.10784428912897],[83.69025605848151, 38.42956813042821],[92.06117372004336, 21.37296420399104],[89.36802573165853, 20.0512403626918],[88.04630189035929, 22.744388351076616],[74.92048383292575, 16.30259356746702],[76.242207674225, 13.609445579082205],[73.2405410666543, 12.136309184064647],[69.98349349800625, 11.380151530599331],[69.30505557348937, 14.302431801650899],[23.54362835223026, 3.678437924516869],[24.222066276747142, 0.7561576534653014],[20.9650187080991, -1.2434497875801753e-14],[17.621348081178695, -1.0451343656542186e-14],[17.6213480811787, 2.9999999999999893],[3.0000000000000018, 2.9999999999999982],[3.0, -1.7793207889194173e-15]]);
}
penta()extend()arc();
